<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atomic Habits for Sales Excellence Infographic</title>
    <!-- Chosen Palette: Vibrant & Professional (Blue, Green, Yellow, Red on a neutral background) -->
    <!-- Application Structure Plan: The SPA is structured as a top-to-bottom narrative. It starts with a compelling hook (The Math of 1%), explains the core principle (Marginal Gains), presents the problem (Why we fail), provides the solution (The 4 Laws), deepens the understanding (Identity-Based Habits), adds inspiration (Success Stories), and ends with a clear call to action. This flow is designed to guide the user logically from concept to application, making it highly persuasive and actionable for a sales team. It now includes interactive Gemini API features for personalized action plans and objection handling. -->
    <!-- Visualization & Content Choices: 
        - The Math of 1%: Goal: Compare. Viz: Line Chart (Chart.js) to dramatically show the divergence of growth vs. decay. Justification: A line chart is the most effective way to visualize compounding over time.
        - Sales Improvement Areas: Goal: Compare. Viz: Horizontal Bar Chart (Chart.js). Justification: A bar chart easily compares distinct categories, and the horizontal layout accommodates longer Thai labels well.
        - The 4 Laws: Goal: Organize. Viz: Flow Diagram (HTML/CSS/Tailwind). Justification: A visual flow clearly shows the process and connection between the laws, enhancing memorability without using prohibited SVG/Mermaid.
        - Identity-Based Habits: Goal: Compare. Viz: Side-by-side card layout. Justification: Directly contrasts "wrong" vs. "right" approaches for immediate clarity.
        - Success Stories: Goal: Inform/Inspire. Viz: Card layout. Justification: Presents distinct, culturally relevant examples clearly and concisely to build user motivation before the final call to action.
        - Gemini Features: Goal: Interact/Apply. Viz: Interactive forms. Justification: Allows users to input their specific needs (identity, objections) and receive tailored, actionable advice from an LLM, bridging the gap between theory and practice.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Kanit', sans-serif;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }
        .flow-arrow {
            font-size: 2.5rem;
            color: #FFD166;
            transform: rotate(90deg);
        }
        @media (min-width: 1024px) {
            .flow-arrow {
                transform: rotate(0deg);
            }
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #118AB2;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50" style="color: #073B4C;">

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center my-12 md:my-16">
            <h1 class="text-4xl md:text-6xl font-bold" style="color: #118AB2;">พัฒนาทีมขายให้โตแบบก้าวกระโดด</h1>
            <h2 class="text-2xl md:text-3xl font-semibold mt-2" style="color: #073B4C;">ด้วยพลังของ 1%</h2>
            <p class="mt-6 max-w-3xl mx-auto text-lg md:text-xl text-gray-600">
                จะเกิดอะไรขึ้น... ถ้าทีมขายของเราเก่งขึ้นแค่วันละ 1%? เราไม่ได้พูดถึงการเปลี่ยนแปลงที่ยิ่งใหญ่ แต่คือ "การปรับปรุงเล็กๆ น้อยๆ" ที่ทำอย่างสม่ำเสมอ ซึ่งจะสร้างผลลัพธ์ที่น่าอัศจรรย์
            </p>
        </header>

        <section class="my-16 md:my-24">
            <div class="bg-white rounded-2xl shadow-lg p-6 md:p-10">
                <h3 class="text-2xl md:text-3xl font-bold text-center mb-2">พลังของการสะสม</h3>
                <p class="text-center text-gray-600 max-w-2xl mx-auto mb-8">ความแตกต่างเพียงเล็กน้อยในแต่ละวัน นำไปสู่ผลลัพธ์ที่ต่างกันมหาศาลในระยะยาว นี่คือสิ่งที่คณิตศาสตร์พิสูจน์ให้เราเห็น</p>
                <div class="chart-container">
                    <canvas id="compoundingChart"></canvas>
                </div>
                <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6 text-center">
                    <div class="p-4 rounded-lg" style="background-color: #E0F2F1;">
                        <p class="text-xl font-semibold">ดีขึ้น 1% ทุกวัน</p>
                        <p class="text-3xl font-bold mt-1" style="color: #06D6A0;">เก่งขึ้น 37 เท่าใน 1 ปี</p>
                    </div>
                    <div class="p-4 rounded-lg" style="background-color: #FFEBEE;">
                        <p class="text-xl font-semibold">แย่ลง 1% ทุกวัน</p>
                        <p class="text-3xl font-bold mt-1" style="color: #FF6B6B;">ศักยภาพเหลือแค่ 3%</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="my-16 md:my-24">
            <h3 class="text-3xl md:text-4xl font-bold text-center mb-12">หลักการข้อที่ 1: สะสมชัยชนะเล็กๆ</h3>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center">
                <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                    <h4 class="text-2xl font-bold mb-4" style="color: #118AB2;">เรื่องเล่าทีมจักรยานอังกฤษ</h4>
                    <p class="text-gray-700 leading-relaxed">จากทีมที่ไม่เคยชนะอะไรเลยใน 100 ปี พวกเขากลายเป็นแชมป์โลกด้วยการ "ปรับปรุงทุกอย่างดีขึ้น 1%" ไม่ว่าจะเป็นเบาะจักรยาน หมอนที่นักกีฬานอน หรืออาหารที่กิน หลักการนี้เรียกว่า <span class="font-semibold">Aggregation of Marginal Gains</span></p>
                    <p class="mt-4 text-center font-semibold text-lg italic p-4 bg-gray-100 rounded-lg">"สูตรสำเร็จคือ เล็ก + ต่อเนื่อง + เวลา = ปาฏิหาริย์"</p>
                </div>
                <div class="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                     <h4 class="text-2xl font-bold mb-4 text-center" style="color: #118AB2;">เราจะปรับปรุง 1% ในจุดไหนได้บ้าง?</h4>
                     <p class="text-center text-gray-600 mb-6">สำหรับทีมขาย การปรับปรุงเล็กๆ ในกิจกรรมหลักเหล่านี้ สามารถสร้างความเปลี่ยนแปลงที่ยิ่งใหญ่ได้</p>
                    <div class="chart-container" style="height: 350px; max-height: 350px;">
                        <canvas id="salesFocusChart"></canvas>
                    </div>
                </div>
            </div>
        </section>
        
        <section class="my-16 md:my-24 text-center">
             <h3 class="text-3xl md:text-4xl font-bold mb-4">ทำไมเราถึงล้มเหลว?</h3>
             <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                เรามักจะตั้งเป้าหมายใหญ่เกินไป ("ฉันจะโทรหาลูกค้าใหม่ 50 คนวันนี้!") ทำให้เหนื่อย ท้อ และเลิกไปในที่สุด สมองของเราต่อต้านการเปลี่ยนแปลงที่ยากลำบาก
             </p>
             <p class="mt-4 text-2xl font-semibold italic" style="color: #FF6B6B;">"การเปลี่ยนแปลงที่ยั่งยืนมาจากการทำเล็กๆ ต่อเนื่อง ไม่ใช่การทำใหญ่ๆ แล้วหยุด"</p>
        </section>

        <section class="my-16 md:my-24">
            <h3 class="text-3xl md:text-4xl font-bold text-center mb-12">หลักการข้อที่ 2: กฎ 4 ข้อเปลี่ยนพฤติกรรม</h3>
            <p class="text-center text-xl text-gray-600 max-w-4xl mx-auto mb-16">นี่คือ "เครื่องมือ" สร้างนิสัยการขายที่ยอดเยี่ยม ที่จะทำให้การพัฒนา 1% ของคุณกลายเป็นเรื่องอัตโนมัติ</p>
            <div class="flex flex-col lg:flex-row justify-center items-center gap-8">
                
                <div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-sm text-center flex-1">
                    <div class="text-5xl mb-4">🎯</div>
                    <h4 class="text-2xl font-bold mb-2" style="color: #118AB2;">1. ทำให้ชัดเจน</h4>
                    <p class="text-gray-600">สร้าง "สัญญาณเตือน" ให้ลงมือทำ เช่น วางลิสต์รายชื่อลูกค้าบนโต๊ะ หรือตั้งแจ้งเตือนในปฏิทินเพื่อ Follow-up</p>
                </div>

                <div class="flow-arrow">➔</div>

                <div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-sm text-center flex-1">
                    <div class="text-5xl mb-4">✨</div>
                    <h4 class="text-2xl font-bold mb-2" style="color: #118AB2;">2. ทำให้น่าดึงดูด</h4>
                    <p class="text-gray-600">เปลี่ยนมุมมองจาก "ต้องทำ" เป็น "ได้ทำ" เช่น "ฉันจะโทรหาลูกค้า แล้วจะได้ฟังเพลงโปรด"</p>
                </div>

                <div class="flow-arrow">➔</div>

                <div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-sm text-center flex-1">
                    <div class="text-5xl mb-4">👟</div>
                    <h4 class="text-2xl font-bold mb-2" style="color: #118AB2;">3. ทำให้ง่าย</h4>
                    <p class="text-gray-600">ใช้ <span class="font-bold">กฎ 2 นาที</span> เริ่มจากสิ่งที่เล็กจนไม่มีข้ออ้าง เช่น "หาข้อมูลลูกค้าใหม่แค่ 1 ราย" ไม่ใช่ 10 ราย</p>
                </div>
                
                <div class="flow-arrow">➔</div>

                <div class="bg-white p-6 rounded-2xl shadow-lg w-full max-w-sm text-center flex-1">
                    <div class="text-5xl mb-4">✅</div>
                    <h4 class="text-2xl font-bold mb-2" style="color: #118AB2;">4. ทำให้น่าพึงพอใจ</h4>
                    <p class="text-gray-600">ให้รางวัลตัวเองทันที เช่น กาเครื่องหมายในปฏิทิน หรือให้รางวัลตัวเองด้วยกาแฟแก้วโปรดเมื่อทำสำเร็จ</p>
                </div>
            </div>
        </section>

        <section class="my-16 md:my-24">
            <h3 class="text-3xl md:text-4xl font-bold text-center mb-12">หลักการข้อที่ 3: สร้างนิสัยจากตัวตน</h3>
            <p class="text-center text-xl text-gray-600 max-w-4xl mx-auto mb-12">นี่คือหลักการที่สำคัญที่สุด ที่จะทำให้การเปลี่ยนแปลงของคุณยั่งยืนตลอดไป</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-red-100 border-l-8 p-8 rounded-2xl shadow-md" style="border-color: #FF6B6B;">
                    <h4 class="text-2xl font-bold mb-4">วิธีที่ผิด: เริ่มจาก "ผลลัพธ์"</h4>
                    <p class="text-lg">"ฉันอยากได้ยอดขาย 1 ล้าน"</p>
                    <p class="mt-2 text-gray-700">วิธีคิดแบบนี้ทำให้การลงมือทำเป็นเหมือน "ภาระ" ที่ต้องทำให้เสร็จๆ ไป เมื่อถึงเป้าหมายก็มักจะหยุดทำ</p>
                </div>
                <div class="bg-green-100 border-l-8 p-8 rounded-2xl shadow-md" style="border-color: #06D6A0;">
                    <h4 class="text-2xl font-bold mb-4">วิธีที่ถูก: เริ่มจาก "ตัวตน"</h4>
                    <p class="text-lg">"ฉันอยากเป็นนักขายที่ลูกค้าไว้วางใจ"</p>
                    <p class="mt-2 text-gray-700">แล้วถามต่อว่า "คนแบบนั้นเขาทำอะไร?" การกระทำจะกลายเป็นเรื่องธรรมชาติ เพราะมันคือสิ่งที่คุณเป็น</p>
                </div>
            </div>
            <p class="mt-8 text-center font-semibold text-2xl italic">"ทุกครั้งที่คุณทำ คุณกำลังพิสูจน์ให้กับตัวเองว่าคุณเป็นคนแบบนั้นจริงๆ"</p>
        </section>

        <!-- Gemini Feature: Action Plan Generator -->
        <section class="my-16 md:my-24 bg-white rounded-2xl shadow-lg p-8 md:p-12">
            <h3 class="text-3xl md:text-4xl font-bold text-center mb-4" style="color: #118AB2;">✨ Action Plan: สร้างแผนปฏิบัติการส่วนตัวของคุณ</h3>
            <p class="text-center text-xl text-gray-600 max-w-3xl mx-auto mb-8">เลือก "ตัวตนของนักขาย" ที่คุณอยากจะเป็น แล้วให้ AI ช่วยสร้างแผนการเริ่มต้นเล็กๆ ที่ทำได้จริงสำหรับคุณ</p>
            <div class="max-w-2xl mx-auto">
                <div class="flex flex-col sm:flex-row gap-4">
                    <select id="identitySelector" class="flex-grow p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none">
                        <option value="นักขายที่ปรึกษา">ฉันอยากเป็น "นักขายที่ปรึกษา"</option>
                        <option value="ผู้เชี่ยวชาญด้านผลิตภัณฑ์">ฉันอยากเป็น "ผู้เชี่ยวชาญด้านผลิตภัณฑ์"</option>
                        <option value="นักสร้างสัมพันธ์มือทอง">ฉันอยากเป็น "นักสร้างสัมพันธ์มือทอง"</option>
                        <option value="นักปิดการขายที่เฉียบคม">ฉันอยากเป็น "นักปิดการขายที่เฉียบคม"</option>
                    </select>
                    <button id="generatePlanBtn" class="bg-green-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-600 transition-colors" style="background-color: #06D6A0;">สร้างแผนปฏิบัติการ</button>
                </div>
                <div id="planLoader" class="loader hidden"></div>
                <div id="planResult" class="mt-6 p-6 bg-gray-100 rounded-lg text-left hidden"></div>
            </div>
        </section>

        <!-- Gemini Feature: Objection Handler -->
        <section class="my-16 md:my-24 bg-white rounded-2xl shadow-lg p-8 md:p-12">
            <h3 class="text-3xl md:text-4xl font-bold text-center mb-4" style="color: #118AB2;">✨ เครื่องมือช่วยตอบข้อโต้แย้งของลูกค้า</h3>
            <p class="text-center text-xl text-gray-600 max-w-3xl mx-auto mb-8">เจอปัญหาลูกค้าปฏิเสธ? ลองพิมพ์ข้อโต้แย้งของลูกค้า แล้วให้ AI ช่วยแนะนำแนวทางการตอบกลับอย่างสร้างสรรค์</p>
            <div class="max-w-2xl mx-auto">
                <div class="flex flex-col sm:flex-row gap-4">
                    <input type="text" id="objectionInput" class="flex-grow p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-400 focus:outline-none" placeholder="เช่น ราคาสูงเกินไป, ขอคิดดูก่อน...">
                    <button id="getObjectionHelpBtn" class="bg-blue-500 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-600 transition-colors" style="background-color: #118AB2;">ขอไอเดียตอบกลับ</button>
                </div>
                <div id="objectionLoader" class="loader hidden"></div>
                <div id="objectionResult" class="mt-6 p-6 bg-gray-100 rounded-lg text-left hidden"></div>
            </div>
        </section>
        
        <section class="my-16 md:my-24">
            <h3 class="text-3xl md:text-4xl font-bold text-center mb-12">คุณทำได้! เรื่องราวของคนไทยที่สู้ชีวิต</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white rounded-2xl shadow-lg p-6 text-center">
                    <h4 class="text-xl font-bold">ต๊อบ อิทธิพัทธ์ (เถ้าแก่น้อย)</h4>
                    <p class="mt-2 text-gray-600">จากเด็กติดเกมที่บ้านล้มละลาย เขาเริ่มต้นจากศูนย์ด้วยรถเข็นขายเกาลัด ลองผิดลองถูกนับครั้งไม่ถ้วน จนสร้างอาณาจักรสาหร่ายหมื่นล้าน</p>
                </div>
                <div class="bg-white rounded-2xl shadow-lg p-6 text-center">
                    <h4 class="text-xl font-bold">ธนินท์ เจียรวนนท์ (เจ้าสัวซีพี)</h4>
                    <p class="mt-2 text-gray-600">เริ่มต้นจากการรับช่วงต่อร้านขายเมล็ดพันธุ์เล็กๆ ในเยาวราช แต่ด้วยวิสัยทัศน์และการเรียนรู้ที่ไม่เคยหยุดนิ่ง เขาพัฒนาและต่อยอดธุรกิจอย่างต่อเนื่องจนเป็นเครือซีพีที่ยิ่งใหญ่ระดับโลก</p>
                </div>
                <div class="bg-white rounded-2xl shadow-lg p-6 text-center">
                    <h4 class="text-xl font-bold">ปัญญา นิรันดร์กุล (เวิร์คพอยท์)</h4>
                    <p class="mt-2 text-gray-600">จากคนทำงานเบื้องหลังในวงการบันเทิง เขาใช้ความมุ่งมั่นและความคิดสร้างสรรค์สะสมประสบการณ์ทุกวัน จนสามารถก่อตั้งบริษัทเวิร์คพอยท์ที่ผลิตรายการโทรทัศน์ที่ประสบความสำเร็จมากมาย</p>
                </div>
            </div>
        </section>

        <footer class="text-center my-16 md:my-24">
            <h3 class="text-3xl md:text-4xl font-bold mb-4">คุณคือสถาปนิกของชีวิตคุณ</h3>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                "สิ่งเดียวที่แยกคุณกับคนที่ประสบความสำเร็จไม่ใช่พรสวรรค์ ไม่ใช่โชคดี แต่คือการเริ่มต้น"
            </p>
            <a href="#" class="mt-8 inline-block bg-blue-500 text-white font-bold py-3 px-8 rounded-full text-lg hover:bg-blue-600 transition-colors" style="background-color: #118AB2;">ไปเริ่มต้น 1% ของคุณ เดี๋ยวนี้เลย!</a>
        </footer>

    </div>

    <script>
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        const wrapLabel = (label, maxWidth = 16) => {
            if (label.length <= maxWidth) return label;
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + ' ' + word).trim().length > maxWidth) {
                    lines.push(currentLine.trim());
                    currentLine = word;
                } else {
                    currentLine = (currentLine + ' ' + word).trim();
                }
            }
            if (currentLine) lines.push(currentLine.trim());
            return lines;
        };

        const compoundingData = {
            labels: Array.from({ length: 365 }, (_, i) => i + 1),
            datasets: [
                {
                    label: 'ดีขึ้น 1% ทุกวัน',
                    data: Array.from({ length: 365 }, (_, i) => Math.pow(1.01, i + 1)),
                    borderColor: '#06D6A0',
                    backgroundColor: 'rgba(6, 214, 160, 0.1)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 0,
                },
                {
                    label: 'แย่ลง 1% ทุกวัน',
                    data: Array.from({ length: 365 }, (_, i) => Math.pow(0.99, i + 1)),
                    borderColor: '#FF6B6B',
                    backgroundColor: 'rgba(255, 107, 107, 0.1)',
                    fill: true,
                    tension: 0.4,
                    pointRadius: 0,
                }
            ]
        };
        new Chart(document.getElementById('compoundingChart'), {
            type: 'line',
            data: compoundingData,
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: { 
                        beginAtZero: true,
                        title: { display: true, text: 'ความสามารถ (เท่า)' }
                    },
                    x: { 
                        title: { display: true, text: 'วัน' }
                    }
                },
                plugins: {
                    tooltip: { callbacks: { title: tooltipTitleCallback } },
                    legend: { position: 'top' }
                }
            }
        });

        const salesFocusLabels = [
            'เพิ่มจำนวนการเข้าพบลูกค้าใหม่',
            'โทรติดตามลูกค้าที่คาดหวัง',
            'เพิ่มความรู้เกี่ยวกับสินค้า',
            'พัฒนาวิธีการตอบข้อโต้แย้ง'
        ];
        const salesFocusData = {
            labels: salesFocusLabels.map(label => wrapLabel(label)),
            datasets: [{
                label: 'ระดับความสำคัญในการพัฒนา',
                data: [85, 90, 75, 80],
                backgroundColor: ['#118AB2', '#06D6A0', '#FFD166', '#FF6B6B'],
                borderRadius: 8,
                borderWidth: 0
            }]
        };
        new Chart(document.getElementById('salesFocusChart'), {
            type: 'bar',
            data: salesFocusData,
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: { 
                        beginAtZero: true,
                        max: 100,
                        grid: { display: false },
                        ticks: { display: false }
                    },
                    y: {
                        grid: { display: false }
                    }
                },
                plugins: {
                    tooltip: { callbacks: { title: tooltipTitleCallback } },
                    legend: { display: false }
                }
            }
        });

        // Gemini API Integration
        const generatePlanBtn = document.getElementById('generatePlanBtn');
        const identitySelector = document.getElementById('identitySelector');
        const planLoader = document.getElementById('planLoader');
        const planResult = document.getElementById('planResult');

        const getObjectionHelpBtn = document.getElementById('getObjectionHelpBtn');
        const objectionInput = document.getElementById('objectionInput');
        const objectionLoader = document.getElementById('objectionLoader');
        const objectionResult = document.getElementById('objectionResult');

        const callGemini = async (prompt) => {
            // --- การตั้งค่าสำคัญสำหรับ API ---
            // 1. ไปที่ Google AI Studio เพื่อสร้าง API Key ฟรี: https://aistudio.google.com/app/apikey
            // 2. นำ API Key ที่ได้มาวางแทนที่ "YOUR_API_KEY_HERE"
            const apiKey = "AIzaSyCXUJ5FM7grHRsetuLUdX084mLc5APxnYg"; 

            if (apiKey === "YOUR_API_KEY_HERE" || !apiKey) {
                const errorMessage = `
                    <p class="text-red-600 font-bold">ข้อผิดพลาด: กรุณาใส่ API Key ของคุณก่อน</p>
                    <p class="mt-2">คุณต้องมี API Key เพื่อใช้งานฟีเจอร์นี้ สามารถสร้างคีย์ได้ฟรีที่ Google AI Studio</p>
                    <a href="https://aistudio.google.com/app/apikey" target="_blank" class="inline-block mt-2 text-blue-600 hover:underline">ไปที่ Google AI Studio เพื่อสร้างคีย์ →</a>
                `;
                return errorMessage;
            }
            
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{
                    role: "user",
                    parts: [{ text: prompt }]
                }],
                generationConfig: {
                    temperature: 0.7,
                    topK: 1,
                    topP: 1,
                    maxOutputTokens: 8192,
                },
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorBody = await response.json();
                    console.error("API Error Body:", errorBody);
                    throw new Error(`API Error: ${response.status} ${response.statusText}`);
                }

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    console.error("Unexpected API response structure:", result);
                    return "ขออภัย ไม่สามารถสร้างคำตอบได้ในขณะนี้เนื่องจากรูปแบบการตอบกลับไม่คาดคิด";
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return "เกิดข้อผิดพลาดในการเชื่อมต่อกับ AI กรุณาตรวจสอบ API Key และการเชื่อมต่ออินเทอร์เน็ตของคุณ";
            }
        };

        generatePlanBtn.addEventListener('click', async () => {
            const selectedIdentity = identitySelector.value;
            planLoader.classList.remove('hidden');
            planResult.classList.add('hidden');

            const prompt = `ในฐานะโค้ชการขายผู้เชี่ยวชาญด้าน Atomic Habits จงสร้าง "แผนปฏิบัติการ 2 นาที" สำหรับนักขายที่ต้องการสร้างตัวตนเป็น "${selectedIdentity}" โดยให้คำแนะนำที่ทำได้จริง 3-4 ข้อ แต่ละข้อให้สั้นกระชับและขึ้นต้นด้วยอีโมจิที่เกี่ยวข้อง`;
            
            const resultText = await callGemini(prompt);
            planLoader.classList.add('hidden');
            planResult.innerHTML = resultText.replace(/\n/g, '<br>');
            planResult.classList.remove('hidden');
        });

        getObjectionHelpBtn.addEventListener('click', async () => {
            const objection = objectionInput.value;
            if (!objection.trim()) {
                objectionResult.innerHTML = '<p class="text-red-500">กรุณาป้อนข้อโต้แย้งของลูกค้า</p>';
                objectionResult.classList.remove('hidden');
                return;
            }

            objectionLoader.classList.remove('hidden');
            objectionResult.classList.add('hidden');

            const prompt = `ในฐานะโค้ชการขายมืออาชีพ จงแนะนำแนวทางการตอบข้อโต้แย้งของลูกค้าที่ว่า "${objection}" มา 3 แนวทาง โดยเน้นการสร้างความสัมพันธ์และนำเสนอคุณค่า ไม่ใช่การลดราคา แต่ละแนวทางให้ขึ้นต้นด้วยอีโมจิที่สื่อถึงกลยุทธ์นั้นๆ และอธิบายสั้นๆ`;

            const resultText = await callGemini(prompt);
            objectionLoader.classList.add('hidden');
            objectionResult.innerHTML = resultText.replace(/\n/g, '<br>');
            objectionResult.classList.remove('hidden');
        });

    </script>
</body>
</html>
